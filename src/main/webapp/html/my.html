<html>
<head>
    <title>RPG</title>
    <script src=https://code.jquery.com/jquery-3.6.0.min.js></script>
    <script>
        $.get("/rest/players/?pageNumber=0&pageSize=5", function (data) {
            var table = $("#t-body");
            $.each(data, function (i, members) {
                var row = $("<tr><td>" + (i + 1) + "</td><td>" + members.name + "</td><td>" + members.title + "</td><td>" + members.race + "</td><td>" + members.profession + "</td><td>"
                    + members.level + "</td><td>" + members.birthday + "</td><td>" + members.banned + "</td></tr>");
                table.append(row);
            });
        });

        $.get('/rest/players/count', function (data) {
            let pageSize = $('#myDropdown').val();
            let chunk = Math.ceil(data / pageSize);
            const numberButton = document.getElementById('page-number');
            numberButton.innerHTML = '';
            for (let i = 1; i <= chunk; i++) {
                let button = $('<button>'+ i +'</button>');
                $('#page-number').append(button);
                button.attr('id', 'b-num');
                button.attr('value', i);
            }
        });

        $(document).ready(function () {
            $('#myDropdown').click(() => {

                let pageSize = $('#myDropdown').val();

                $.get('/rest/players/?pageNumber=0&pageSize=' + pageSize + '', function (data) {
                    var table = $('#my-table');
                    const t = document.getElementById('t-body');
                    t.innerHTML = '';
                    $.each(data, function (i, members) {
                        var row = $("<tr><td>" + (i + 1) + "</td><td>" + members.name + "</td><td>" + members.title + "</td><td>" + members.race + "</td><td>" + members.profession + "</td><td>"
                            + members.level + "</td><td>" + members.birthday + "</td><td>" + members.banned + "</td></tr>");
                        table.append(row);
                    });
                });

                $.get('/rest/players/count', function (data) {
                    let chunk = Math.ceil(data / pageSize);
                    const numberButton = document.getElementById('page-number');
                    numberButton.innerHTML = '';
                    for (let i = 1; i <= chunk; i++) {
                        let button = $('<button>'+ i +'</button>');
                        $('#page-number').append(button);
                        button.attr('id', 'b-num');
                        button.attr('value', i);
                    }
                });
            });

            $('#page-number').on('click', 'button', function() {
                let pageSize = $('#myDropdown').val();
                let pageNumber = $(this).val() - 1;
                $.get('/rest/players/?pageNumber=' + pageNumber + '&pageSize=' + pageSize + '', function (data) {
                    var table = $('#my-table');
                    const t = document.getElementById('t-body');
                    t.innerHTML = '';
                    $.each(data, function (i, members) {
                        console.log(data);
                        var row = $("<tr><td>"  + (i + data[0].id) + "</td><td>" + members.name + "</td><td>" + members.title + "</td><td>" + members.race + "</td><td>" + members.profession + "</td><td>"
                            + members.level + "</td><td>" + members.birthday + "</td><td>" + members.banned + "</td></tr>");
                        table.append(row);
                    });
                });
            });
        });
    </script>
    <link href="/css/my.css" rel="stylesheet">
</head>
<body>
<h1>RPG admin panel</h1>
<h2>Accounts list:</h2>
<div>
    <caption>Count per page:</caption>
    <select id='myDropdown'>
        <option value='5'>5</option>
        <option value='10'>10</option>
        <option value='15'>15</option>
        <option value='20'>20</option>
    </select>
</div>
<table id='my-table' class='table'>
    <thead>
        <tr>
            <th>#</th>
            <th>Name</th>
            <th>Title</th>
            <th>Race</th>
            <th>Profession</th>
            <th>Level</th>
            <th>Birthday</th>
            <th>Banned</th>
        </tr>
    </thead>
    <tbody id='t-body'>

    </tbody>
</table>
<div>
    <caption>Pages:</caption>
    <div id='page-number'></div>
</div>
</body>
</html>